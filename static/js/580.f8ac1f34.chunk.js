"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[580],{287:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(791),s=n(303),a=n(307),o=n(155),c=n(87),u=n(184);function i(){var e=(0,r.useContext)(s.Z).firebase,t=(0,r.useContext)(a.Z).user;return(0,u.jsx)("header",{className:"h-16 bg-white border-b border-gray-primary mb-8",children:(0,u.jsx)("div",{className:"container mx-auto max-w-screen-lg h-full",children:(0,u.jsxs)("div",{className:"flex justify-between h-full",children:[(0,u.jsx)("div",{className:"text-gray-700 text-center flex items-center align-items cursor-pointer",children:(0,u.jsx)("h1",{className:"flex justify-center w-full",children:(0,u.jsx)(c.rU,{to:o.h1,"aria-label":"Instagram",children:(0,u.jsx)("img",{src:"/images/logo.png",className:"mt-2 w-6/12"})})})}),(0,u.jsx)("div",{className:"text-gray-700 text-center flex items-center aligh-items",children:t?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.rU,{to:o.h1,"aria-label":"Dashboard",children:(0,u.jsx)("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),(0,u.jsx)("button",{type:"button",title:"Sign out",onClick:function(){return e.auth().signOut()},onKeyDown:function(t){"Enter"===t.key&&e.auth().signOut()},children:(0,u.jsx)("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})}),(0,u.jsx)("div",{className:"flex items-center cursor-pointer",children:(0,u.jsx)(c.rU,{to:"/p/".concat(t.displayName),children:(0,u.jsx)("img",{className:"rounded-full h-8 w-8 flex",src:"/images/avatars/".concat(t.displayName,".jpg"),alt:"".concat(t.displayName," profile")})})})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(c.rU,{to:o.ym,children:(0,u.jsx)("button",{type:"button",className:"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8",children:"Log in"})}),(0,u.jsx)(c.rU,{to:o._5,children:(0,u.jsx)("button",{type:"button",className:"font-bold text-sm rounded text-blue-medium w-20 h-8",children:"Sign up"})})]})})]})})})}},555:function(e,t,n){var r=n(791),s=n(87),a=n(839),o=n(184),c=function(e){var t=e.username,n=e.fullName;return t&&n?(0,o.jsx)(s.rU,{to:"/p/".concat(t),className:"grid grid-cols-4 gap-4 mb-6 items-center",children:(0,o.jsxs)("div",{className:"flex items-center justify-between col-span-1",children:[(0,o.jsx)("img",{className:"rounded-full w-16 flex mr-3",src:"/images/avatars/".concat(t,".jpg"),alt:""}),(0,o.jsxs)("div",{className:"col-span-3",children:[(0,o.jsx)("p",{className:"font-bold text-sm",children:t}),(0,o.jsx)("p",{className:"text-sm",children:n})]})]})}):(0,o.jsx)(a.Z,{count:1,height:61})};t.Z=(0,r.memo)(c)},807:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(165),s=n(861),a=n(439),o=n(791),c=n(307),u=n(606);function i(){var e=(0,o.useState)({}),t=(0,a.Z)(e,2),n=t[0],i=t[1],l=(0,o.useContext)(c.Z).user;return(0,o.useEffect)((function(){function e(){return(e=(0,s.Z)((0,r.Z)().mark((function e(){var t,n,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.xD)(l.uid);case 2:t=e.sent,n=(0,a.Z)(t,1),s=n[0],i(s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!==l&&void 0!==l&&l.uid&&function(){e.apply(this,arguments)}()}),[l]),{user:n}}},580:function(e,t,n){n.r(t),n.d(t,{default:function(){return L}});var r=n(791),s=n(287),a=n(807),o=n(165),c=n(861),u=n(439),i=n(839),l=n(606),d=n(87),p=n(184);function m(e){var t=e.profileDocId,n=e.username,s=e.profileId,a=e.userId,i=e.loggedInUserDocId,m=(0,r.useState)(!1),f=(0,u.Z)(m,2),x=f[0],h=f[1];function v(){return(v=(0,c.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,(0,l.NS)(i,s,!1);case 3:return e.next=5,(0,l.T6)(t,a,!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return x?null:(0,p.jsxs)("div",{className:"flex flex-row items-center align-items justify-between",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between",children:[(0,p.jsx)("img",{className:"rounded-full w-8 flex mr-3",src:"/images/avatars/".concat(n,".jpg"),alt:""}),(0,p.jsx)(d.rU,{to:"/p/".concat(n),children:(0,p.jsx)("p",{className:"font-bold text-sm",children:n})})]}),(0,p.jsx)("button",{className:"text-xs font-bold text-blue-medium ",type:"button",onClick:function(){return v.apply(this,arguments)},children:"Follow"})]})}function f(e){var t=e.userId,n=e.following,s=e.loggedInUserDocId,a=(0,r.useState)(null),d=(0,u.Z)(a,2),f=d[0],x=d[1];return(0,r.useEffect)((function(){function e(){return(e=(0,c.Z)((0,o.Z)().mark((function e(){var r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.ve)(t,n);case 2:r=e.sent,x(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t&&function(){e.apply(this,arguments)}()}),[t]),f?f.length>0?(0,p.jsxs)("div",{className:"rounded flex flex-col",children:[(0,p.jsx)("p",{className:"font-bold text-gray-base",children:"Suggestions for you"}),(0,p.jsx)("div",{className:"mt-4 grid gap-5",children:f.map((function(e){return(0,p.jsx)(m,{profileDocId:e.docId,username:e.username,profileId:e.userId,userId:t,loggedInUserDocId:s},e.docId)}))})]}):null:(0,p.jsx)(i.Z,{count:1,height:150,className:"mt-5"})}var x=n(555);function h(){var e=(0,a.Z)().user,t=e.docId,n=e.fullName,r=e.username,s=e.userId,o=e.following;return(0,p.jsxs)("div",{className:"p-4",children:[(0,p.jsx)(x.Z,{username:r,fullName:n}),(0,p.jsx)(f,{userId:s,following:o,loggedInUserDocId:t})]})}var v=n(307);function g(e){var t=e.username;return(0,p.jsx)("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8",children:(0,p.jsx)("div",{className:"flex items-center",children:(0,p.jsxs)(d.rU,{to:"/p/".concat(t),className:"flex items-center",children:[(0,p.jsx)("img",{className:"rounded-full h-8 w-8 flex mr-3",src:"/images/avatars/".concat(t,".jpg"),alt:"".concat(t," profile picture")}),(0,p.jsx)("p",{className:"font-bold",children:t})]})})})}function w(e){var t=e.src,n=e.caption;return(0,p.jsx)("img",{src:t,alt:n})}var j=n(303);function Z(e){var t=e.docId,n=e.totalLikes,s=e.likedPhoto,a=e.handleFocus,i=(0,r.useContext)(v.Z).user.uid,l=void 0===i?"":i,d=(0,r.useState)(s),m=(0,u.Z)(d,2),f=m[0],x=m[1],h=(0,r.useState)(n),g=(0,u.Z)(h,2),w=g[0],Z=g[1],y=(0,r.useContext)(j.Z),b=y.firebase,N=y.FieldValue,k=function(){var e=(0,c.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x((function(e){return!e})),e.next=3,b.firestore().collection("photos").doc(t).update({likes:f?N.arrayRemove(l):N.arrayUnion(l)});case 3:Z((function(e){return f?e-1:e+1}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"flex justify-between p-4",children:(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)("svg",{onClick:k,onKeyDown:function(e){"Enter"===e.key&&k()},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none cursor-pointer focus:outline-none ".concat(f?"fill-red text-red-primary":"text-black-light"),children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,p.jsx)("svg",{onClick:a,onKeyDown:function(e){"Enter"===e.key&&a()},className:"w-8 text-black-light select-none cursor-pointer focus:outline-none",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})]})}),(0,p.jsx)("div",{className:"p-4 py-0",children:(0,p.jsx)("p",{className:"font-bold",children:"".concat(w,1===w?" like":" likes")})})]})}function y(e){var t=e.caption,n=e.username;return(0,p.jsxs)("div",{className:"p-4 pt-2 pb-0",children:[(0,p.jsx)("span",{className:"mr-1 font-bold",children:n}),(0,p.jsx)("span",{children:t})]})}var b=n(346),N=n(433);function k(e){var t=e.docId,n=e.comments,s=e.setComments,a=e.commentInput,o=(0,r.useState)(""),c=(0,u.Z)(o,2),i=c[0],l=c[1],d=(0,r.useContext)(j.Z),m=d.firebase,f=d.FieldValue,x=(0,r.useContext)(v.Z).user.displayName,h=function(e){return e.preventDefault(),s([{displayName:x,comment:i}].concat((0,N.Z)(n))),l(""),m.firestore().collection("photos").doc(t).update({comments:f.arrayUnion({displayName:x,comment:i})})};return(0,p.jsx)("div",{className:"border-t border-gray-primary",children:(0,p.jsxs)("form",{className:"flex justify-between pl-0 pr-5",method:"POST",onSubmit:function(e){return i.length>=1?h(e):e.preventDefault()},children:[(0,p.jsx)("input",{"aria-label":"Add a comment",autoComplete:"off",className:"text-sm text-gray-base w-full mr-3 py-5 px-4",type:"text",name:"add-comment",placeholder:"Add a comment",value:i,onChange:function(e){var t=e.target;return l(t.value)},ref:a}),(0,p.jsx)("button",{className:"text-sm font-bold text-blue-medium ".concat(!i&&"opacity-25"),type:"button",disabled:i.length<1,onClick:h,children:" Post "})]})})}function I(e){var t=e.docId,n=e.comments,s=e.posted,a=e.commentInput,o=(0,r.useState)(n),c=(0,u.Z)(o,2),i=c[0],l=c[1];return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"p-4 pt-1 pb-4",children:[i.length>=3&&(0,p.jsxs)("p",{className:"text-sm text-gray-base mb-1 cursor-pointer",children:["View all ",i.length," comments"]}),i.slice(0,3).map((function(e){return(0,p.jsxs)("p",{className:"mb-1",children:[(0,p.jsx)(d.rU,{to:"/p/".concat(e.displayName),children:(0,p.jsxs)("span",{className:"mr-1 font-bold",children:[" ",e.displayName]})}),(0,p.jsx)("span",{children:e.comment})]},"".concat(e.comment,"-").concat(e.displayName))})),(0,p.jsxs)("p",{className:"text-gray-base uppercase text-xs",children:[(0,b.Z)(s,new Date)," ago"]})]}),(0,p.jsx)(k,{docId:t,comments:i,setComments:l,commentInput:a})]})}function C(e){var t=e.content,n=(0,r.useRef)(null);return(0,p.jsxs)("div",{className:"rounded col-span-4 border bg-white border-gray-primary mb-16",children:[(0,p.jsx)(g,{username:t.username}),(0,p.jsx)(w,{src:t.imageSrc,caption:t.caption}),(0,p.jsx)(Z,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:function(){return n.current.focus()}}),(0,p.jsx)(y,{caption:t.caption,username:t.username}),(0,p.jsx)(I,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:n})]})}function U(){var e=function(){var e=(0,r.useState)(null),t=(0,u.Z)(e,2),n=t[0],s=t[1],a=(0,r.useContext)(v.Z).user.uid,i=void 0===a?"":a;return(0,r.useEffect)((function(){function e(){return(e=(0,c.Z)((0,o.Z)().mark((function e(){var t,n,r,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.xD)(i);case 2:if(t=e.sent,n=(0,u.Z)(t,1),r=n[0].following,a=[],!(r.length>0)){e.next=10;break}return e.next=9,(0,l.wP)(i,r);case 9:a=e.sent;case 10:a.sort((function(e,t){return t.dateCreated-e.dateCreated})),s(a);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[i]),{photos:n}}(),t=e.photos;return console.log("photos",t),(0,p.jsx)("div",{className:"container col-span-2",children:t?(null===t||void 0===t?void 0:t.length)>0?t.map((function(e){return(0,p.jsx)(C,{content:e},e.docId)})):(0,p.jsx)("p",{className:"text-center text-2xl",children:" Follow people to see photos"}):(0,p.jsx)(i.Z,{count:4,width:640,height:500,className:"mb-5"})})}function L(){return(0,r.useEffect)((function(){document.title="Instagram"}),[]),(0,p.jsxs)("div",{className:"bg-gray-background",children:[(0,p.jsx)(s.Z,{}),(0,p.jsxs)("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg",children:[(0,p.jsx)(U,{}),(0,p.jsx)(h,{})]})]})}},606:function(e,t,n){n.d(t,{Gm:function(){return I},IU:function(){return N},NS:function(){return h},T6:function(){return g},_T:function(){return y},dQ:function(){return l},ve:function(){return f},wP:function(){return j},xD:function(){return p},zl:function(){return u}});var r=n(439),s=n(413),a=n(165),o=n(861),c=(n(555),n(82));function u(e){return i.apply(this,arguments)}function i(){return(i=(0,o.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.w.firestore().collection("users").where("username","==",t).get();case 2:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return e.data().length>0})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return(d=(0,o.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.w.firestore().collection("users").where("username","==",t.toLowerCase()).get();case 2:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return(0,s.Z)((0,s.Z)({},e.data()),{},{docId:e.id})})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=(0,o.Z)((0,a.Z)().mark((function e(t){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.w.firestore().collection("users").where("userId","==",t).get();case 2:return n=e.sent,r=n.docs.map((function(e){return(0,s.Z)((0,s.Z)({},e.data()),{},{docId:e.id})})),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,t){return x.apply(this,arguments)}function x(){return(x=(0,o.Z)((0,a.Z)().mark((function e(t,n){var r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.w.firestore().collection("users").limit(10).get();case 2:return r=e.sent,e.abrupt("return",r.docs.map((function(e){return(0,s.Z)((0,s.Z)({},e.data()),{},{docId:e.id})})).filter((function(e){return e.userId!==t&&!n.includes(e.userId)})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t,n){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.w.firestore().collection("users").doc(t).update({following:r?c.G.arrayRemove(n):c.G.arrayUnion(n)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t,n){return w.apply(this,arguments)}function w(){return(w=(0,o.Z)((0,a.Z)().mark((function e(t,n,r){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.w.firestore().collection("users").doc(t).update({followers:r?c.G.arrayRemove(n):c.G.arrayUnion(n)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t){return Z.apply(this,arguments)}function Z(){return Z=(0,o.Z)((0,a.Z)().mark((function e(t,n){var r,u,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.w.firestore().collection("photos").where("userId","in",n).get();case 2:return r=e.sent,u=r.docs.map((function(e){return(0,s.Z)((0,s.Z)({},e.data()),{},{docId:e.id})})),e.next=6,Promise.all(u.map(function(){var e=(0,o.Z)((0,a.Z)().mark((function e(n){var r,o,c;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,n.likes.includes(t)&&(r=!0),e.next=4,p(n.userId);case 4:return o=e.sent,c=o[0].username,e.abrupt("return",(0,s.Z)((0,s.Z)({username:c},n),{},{userLikedPhoto:r}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}function y(e){return b.apply(this,arguments)}function b(){return(b=(0,o.Z)((0,a.Z)().mark((function e(t){var n,o,u,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:return n=e.sent,o=(0,r.Z)(n,1),u=o[0],console.log("user",u),e.next=8,c.w.firestore().collection("photos").where("userId","==",u.userId).get();case 8:return i=e.sent,e.abrupt("return",i.docs.map((function(e){return(0,s.Z)((0,s.Z)({},e.data()),{},{docId:e.id})})));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return k.apply(this,arguments)}function k(){return(k=(0,o.Z)((0,a.Z)().mark((function e(t,n){var o,u,i,l,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.w.firestore().collection("users").where("username","==",t).where("following","array-contains",n).get();case 2:return o=e.sent,u=o.docs.map((function(e){return(0,s.Z)((0,s.Z)({},e.data()),{},{docId:e.id})})),i=(0,r.Z)(u,1),l=i[0],d=void 0===l?{}:l,e.abrupt("return",d.userId);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,n,r,s){return C.apply(this,arguments)}function C(){return(C=(0,o.Z)((0,a.Z)().mark((function e(t,n,r,s,o){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(n,s,t);case 2:return e.next=4,g(r,o,t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}}]);
//# sourceMappingURL=580.f8ac1f34.chunk.js.map